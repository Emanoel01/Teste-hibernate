package DAO;
import java.util.ArrayList;
import java.util.List;
import javax.persistence.EntityManager;
import conection.ConectionFactory;
import model.ListaChamada;

public class ListaChamadaDAO {
	
	public EntityManager emCliente = new ConectionFactory().getConection();
	
	public Boolean saveListaChamada(List<ListaChamada> listListachamada) {
		
		boolean retorno = false;
		
		try {
			
			for(int i=0;i<listListachamada.size();i++) {
				ListaChamada listaChamada = listListachamada.get(i);
				
				emCliente.getTransaction().begin();
				emCliente.persist(listaChamada);
				emCliente.getTransaction().commit();
				
				retorno = true;
			}

			
			
		}catch (Exception e) {
			System.out.println(e.getMessage());
			emCliente.getTransaction().rollback();
		}finally {
			emCliente.close();
		}
		
		return retorno;
	}
	
	
	@SuppressWarnings( "unchecked")
	public List<String> getDatas(){
		
		List<ListaChamada> listaChamada = null;
		List<String> listaDatas = new ArrayList<>();
		
		try {
			listaChamada = emCliente.createQuery("from ListaChamada lc group by lc.dia").getResultList();
			
			for(ListaChamada chamada : listaChamada) {
				String dia;
				String mes;
				String data;
				
				
				//DIA
				if(chamada.getDia()<10) {
					dia = "0"+chamada.getDia();
				}else {
					dia = String.valueOf(chamada.getDia());
				}
				
				//MES
				if(chamada.getMes()<10) {
					mes = "0"+chamada.getMes();
				}else {
					mes = String.valueOf(chamada.getMes());
				}
				
				//ANO
				data = dia + "/" + mes + "/" + chamada.getAno();
				
				
				listaDatas.add(data);
			}
			
			
		}catch (Exception e) {
			// TODO: handle exception
			System.out.println(e.getMessage());
			emCliente.getTransaction().rollback();
		}finally {
			emCliente.close();
		}
		
		return listaDatas;
		
		
	}
	

	
	


}
